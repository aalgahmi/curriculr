<div class="panel-body">
  <%= render 'teach/questions/preamble', :q => q, :show_answer => show_answer %>
</div>

<table class="<%= css_table %>">
  <% 
  is_sortable = (controller_name == 'questions' && action_name == 'index' && staff?(current_user, @course))
  %>
  <tbody class="<%= 'sortable' if is_sortable  %>" data-update-url="<%= url_for([:sort_option, :teach, @course, @unit, @lecture, q]) if is_sortable %>">
    <% q.options.each do |o| %>
    
      <% html = text_field_tag("attempt[#{q.id}][#{o.id}]", '', :size => [(q.answer[o.id].length + 3), 60].min, 
                  :value => (a ? a[o.id] : nil),
                  :readonly => read_only,
                  :class => css_form_control)  %>
      <% qo = o.option.include?('...') ? o.option : "#{o.option} ..." %>
      <tr id="option_<%= o.id %>">
        <td>
          <%= (processed_text(qo).sub('...', html)).html_safe %>
          <div id="<%= "answer_#{q.id}_#{o.id}"%>" class="question-answer"></div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>