<div id="siteSignInOrUpModal" class="modal fade" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <button type="button" class="close <%= css_align(:right) %>" data-dismiss="modal" >
                <span aria-hidden="true">&times;</span>
              </button>
              <ul id="signinOrUpTabs" class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active">
                  <a href="#signin-tab" role="tab" data-toggle="tab">
                    <%= t('page.text.sign_in') %>
                  </a>
                </li>
                <li role="presentation">
                  <a href="#signup-tab" role="tab" data-toggle="tab">
                    <%= t('page.text.sign_up') %>
                  </a>
                </li>
              </ul>
              <br/>
              <div id="signinOrUpTabContent" class="tab-content">
                <div role="tabpanel" class="tab-pane fade active in" id="signin-tab">
                  <% external_links = capture do %>
                  <% [:facebook, :google_oauth2].each do |app| %>
                    <% app_secrets = Rails.application.secrets.auth[app.to_s] %>
                    <% if app_secrets && app_secrets['id'].present? && app_secrets['secret'].present? %>
                      <% app_name = app == :google_oauth2 ? :google : app %>
                      <div class="col-md-6">
                      <%= link_to omniauth_authorize_path(resource_name, app), :class => css_button(app_name, :lg, :block) do %>
                        <i class="fa fa-<%= app_name %> fa-lg"></i> 
                        <%= t("activerecord.actions.#{app_name}") %>
                      <% end %>
                      </div>
                    <% end %>
                  <% end %>
                  <% end %>

                  <% if external_links.strip.present? %>
                    <%= external_links %>
                    <hr /><br /><br />
                  <% end %>

                  <p class="text-center"><strong><%= t('page.text.or') %></strong></p>

                  <%= render partial: 'users/sessions/new' %>
                </div>
                <div role="tabpanel" class="tab-pane fade" id="signup-tab">
                  <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
                    <%= form_text f, :name %>
                    <%= form_email f, :email %>
                    <%= form_password f, :password %>
                    <%= form_password f, :password_confirmation %>
                    
                    <% if devise_mapping.recoverable? && controller_name != 'passwords' %>
                      <% links = [{ text: t('page.text.registration_terms_and_conditions_html', 
                                    link: link(:page, :terms, localized_page_path(:terms))) }] %>
                    <% end %>
                    <%= form_submit f, false, links %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>